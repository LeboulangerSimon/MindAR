<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AR avec Photos Personnelles</title>
    <script src="https://cdn.jsdelivr.net/npm/mind-ar@0.5.0/dist/mindar.js"></script>
</head>
<body style="margin: 0; overflow: hidden;">
    <!-- Scène AR -->
    <div id="ar-container" style="width: 100vw; height: 100vh; overflow: hidden;">
        <video id="ar-video" width="640" height="480" style="display: none;"></video>
    </div>

    <script>
        // Initialisation de MindAR avec ton fichier .mind
        const mindarThree = new MindAR.Three.MindARThree({
            container: document.querySelector('#ar-container'),
            imageTargetSrc: './assets/targets.mind',  // Chemin vers ton fichier .mind
        });

        const { renderer, scene, camera } = mindarThree;

        const video = document.querySelector('#ar-video');
        video.src = "./assets/video.mp4";  // Chemin vers ta vidéo
        video.load();

        const start = async () => {
            await mindarThree.start();
            renderer.setAnimationLoop(() => {
                renderer.render(scene, camera);
            });

            // Créer une texture vidéo
            const videoTexture = new THREE.VideoTexture(video);

            // Créer un plan 3D avec la texture vidéo
            const geometry = new THREE.PlaneGeometry(1, 1); // Dimensions ajustables
            const material = new THREE.MeshBasicMaterial({ map: videoTexture });
            const plane = new THREE.Mesh(geometry, material);

            // Ajouter le plan à la scène
            const anchor = mindarThree.addAnchor(0); // Utiliser l'index de la cible
            anchor.group.add(plane);

            // Jouer la vidéo quand l'image est détectée
            anchor.onTargetFound = () => {
                video.play();
                video.style.display = 'block';
            };

            // Arrêter la vidéo si l'image n'est plus détectée
            anchor.onTargetLost = () => {
                video.pause();
                video.style.display = 'none';
            };
        }

        start();
    </script>
</body>
</html>
